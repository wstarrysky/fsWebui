# fs-helper-ui 本地打包安装说明

## 项目信息

- **包名**: `fs-helper-ui`
- **CLI命令**: `fsCli`
- **功能**: 只读安全模式的 Claude Code Web 界面

---

## 方式一: Deno 单二进制打包 (推荐)

### 前置条件

```bash
# 安装 Deno
# Windows (PowerShell)
irm https://deno.land/install.ps1 | iex

# macOS/Linux
curl -fsSL https://deno.land/install.sh | sh

# 安装 Node.js (>=20.0.0) 用于前端构建
```

### 打包步骤

```bash
# 1. 进入项目根目录
cd D:\Project\claude-code-webui

# 2. 安装前端依赖
cd frontend && npm install

# 3. 构建前端
npm run build

# 4. 复制前端产物到后端
cd ..
rm -rf backend/dist
cp -r frontend/dist backend/dist

# 5. 编译 Deno 单二进制
cd backend
deno task build
```

### 产物位置

```
dist/fs-helper-ui.exe    # Windows
dist/fs-helper-ui        # macOS/Linux
```

### 使用方式

```bash
# 直接运行
./dist/fs-helper-ui --port 8080

# 或复制到 PATH 目录后直接使用
fs-helper-ui --port 8080
```

---

## 方式二: Node.js npm 包安装

### 打包步骤

```bash
# 1. 构建前端
cd frontend && npm install && npm run build

# 2. 构建后端
cd ../backend
npm install
npm run build

# 3. 本地全局安装
npm install -g .
```

### 使用方式

```bash
# 全局命令
fsCli --port 8080
```

---

## 方式三: 开发模式运行

### 启动步骤

```bash
# 终端 1: 启动后端
cd backend
npm install
npm run dev

# 终端 2: 启动前端
cd frontend
npm install
npm run dev
```

### 访问地址

- 前端: http://localhost:3000
- 后端: http://localhost:8080

---

## 一键打包脚本 (Windows)

创建 `build.bat`:

```batch
@echo off
echo === Building fs-helper-ui ===

echo [1/4] Installing frontend dependencies...
cd frontend
call npm install

echo [2/4] Building frontend...
call npm run build

echo [3/4] Copying frontend to backend...
cd ..
if exist backend\dist rmdir /s /q backend\dist
xcopy /E /I frontend\dist backend\dist\static

echo [4/4] Compiling Deno binary...
cd backend
call deno task build

echo === Build Complete ===
echo Binary location: dist\fs-helper-ui.exe
pause
```

---

## 一键打包脚本 (macOS/Linux)

创建 `build.sh`:

```bash
#!/bin/bash
set -e

echo "=== Building fs-helper-ui ==="

echo "[1/4] Installing frontend dependencies..."
cd frontend
npm install

echo "[2/4] Building frontend..."
npm run build

echo "[3/4] Copying frontend to backend..."
cd ..
rm -rf backend/dist
cp -r frontend/dist backend/dist

echo "[4/4] Compiling Deno binary..."
cd backend
deno task build

echo "=== Build Complete ==="
echo "Binary location: dist/fs-helper-ui"
```

运行: `chmod +x build.sh && ./build.sh`

---

## 使用 Makefile (项目已有)

```bash
# 完整构建流程
make build

# 产物位置
dist/fs-helper-ui
```

---

## CLI 参数

```
fs-helper-ui [options]

Options:
  --port, -p <port>     服务端口 (默认: 8080)
  --debug               启用调试日志
  --help, -h            显示帮助信息
```

---

## 环境变量配置

创建 `.env` 文件:

```bash
PORT=9000              # 自定义端口
```

---

## 验证安装

```bash
# 检查版本
fs-helper-ui --version

# 启动服务
fs-helper-ui --port 8080

# 访问 http://localhost:8080
```
